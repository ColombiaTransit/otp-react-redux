{"version":3,"sources":["user-settings.js"],"names":["UserSettings","_disableTracking","props","toggleTracking","_enableTracking","user","locations","trackRecent","recentSearches","console","log","order","sortedLocations","sort","a","b","aIndex","indexOf","type","bIndex","paddingTop","paddingLeft","paddingRight","paddingBottom","margin","minHeight","backgroundColor","padding","map","location","id","length","search","borderTop","Component","Place","_onSelect","query","setLocation","from","to","_onForget","forgetPlace","forgettable","icon","name","listStyle","whiteSpace","overflow","textOverflow","maxWidth","RecentSearch","setQueryParam","forgetSearch","mode","mapStateToProps","state","ownProps","config","otp","currentQuery","currentPosition","sessionSearches","nearbyStops","stopsIndex","transitIndex","stops","mapDispatchToProps"],"mappings":"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","file":"user-settings.js","sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\n// import PropTypes from 'prop-types'\nimport { Button } from 'react-bootstrap'\n\nimport Icon from '../narrative/icon'\nimport { forgetSearch, toggleTracking } from '../../actions/api'\nimport { setQueryParam } from '../../actions/form'\nimport { forgetPlace, setLocation } from '../../actions/map'\n\nclass UserSettings extends Component {\n  _disableTracking = () => this.props.toggleTracking(false)\n\n  _enableTracking = () => this.props.toggleTracking(true)\n\n  render () {\n    const { user } = this.props\n    const { locations, trackRecent, recentSearches } = user\n    console.log(this.props)\n    const order = ['home', 'work', 'suggested', 'recent']\n    const sortedLocations = locations.sort((a, b) => {\n      const aIndex = order.indexOf(a.type)\n      const bIndex = order.indexOf(b.type)\n      if (aIndex > bIndex) return 1\n      if (aIndex < bIndex) return -1\n      else return 0\n    })\n    return (\n      <div style={{\n        paddingTop: '10px',\n        paddingLeft: '5px',\n        paddingRight: '5px',\n        paddingBottom: '20px',\n        margin: '10px 10px 0 10px',\n        minHeight: '150px',\n        backgroundColor: '#f0f0f0'\n      }}>\n        <div>My places</div>\n        <ul style={{ padding: 0 }}>\n          {sortedLocations.map(location => {\n            return <Place key={location.id} location={location} {...this.props} />\n          })}\n        </ul>\n        {trackRecent &&\n          <div className='recent-searches-container'>\n            <div>Recent searches</div>\n            <ul style={{ padding: 0 }}>\n              {recentSearches.length > 0\n                ? recentSearches.map(search => {\n                  return <RecentSearch key={search.id} search={search} {...this.props} />\n                })\n                : <small>No recent searches</small>\n              }\n            </ul>\n          </div>\n        }\n        <hr style={{ borderTop: '1px solid #ccc' }} />\n        <div>\n          <div>My preferences</div>\n          <small>Remember recent searches/places?</small>\n          <Button\n            onClick={this._enableTracking}\n            style={trackRecent ? { backgroundColor: 'white' } : null}\n            bsSize='xsmall'\n            bsStyle='link'>Yes</Button>\n          <Button\n            onClick={this._disableTracking}\n            style={!trackRecent ? { backgroundColor: 'white' } : null}\n            bsSize='xsmall'\n            bsStyle='link'>No</Button>\n        </div>\n      </div>\n    )\n  }\n}\n\nclass Place extends Component {\n  _onSelect = () => {\n    const { location, query, setLocation } = this.props\n    // console.log('selecting', this.props.id)\n    if (!query.from) setLocation({ type: 'from', location })\n    else if (!query.to) setLocation({ type: 'to', location })\n  }\n\n  _onForget = () => this.props.forgetPlace(this.props.location.id)\n\n  render () {\n    const { forgettable, icon, name } = this.props.location\n    return (\n      <li style={{ listStyle: 'none' }}>\n        <Button\n          bsStyle='link'\n          title={name}\n          style={{\n            padding: '5px 0 0 0',\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            maxWidth: '275px'\n          }}\n          onClick={this._onSelect}>\n          <span><Icon type={icon} /> {name}</span>\n        </Button>\n        <span className='pull-right'>\n          {forgettable &&\n            <Button\n              onClick={this._onForget}\n              bsSize='xsmall'\n              style={{ paddingTop: '6px' }}\n              bsStyle='link'>Clear</Button>\n          }\n        </span>\n      </li>\n    )\n  }\n}\n\nclass RecentSearch extends Component {\n  _onSelect = () => {\n    const { search, setQueryParam } = this.props\n    setQueryParam(search.query)\n  }\n\n  _onForget = () => this.props.forgetSearch(this.props.search.id)\n\n  render () {\n    const { search } = this.props\n    const { query } = search\n    const name = `${query.mode} from ${query.from.name} to ${query.to.name}`\n    return (\n      <li style={{ listStyle: 'none' }}>\n        <Button\n          bsStyle='link'\n          title={name}\n          style={{\n            padding: '5px 0 0 0',\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            maxWidth: '275px'\n          }}\n          onClick={this._onSelect}>\n          <span><Icon type='clock-o' /> {name}</span>\n        </Button>\n        <span className='pull-right'>\n          <Button\n            onClick={this._onForget}\n            bsSize='xsmall'\n            style={{ paddingTop: '6px' }}\n            bsStyle='link'>Clear</Button>\n        </span>\n      </li>\n    )\n  }\n}\n\n// connect to redux store\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    config: state.otp.config,\n    user: state.otp.user,\n    query: state.otp.currentQuery,\n    currentPosition: state.otp.location.currentPosition,\n    sessionSearches: state.otp.location.sessionSearches,\n    nearbyStops: state.otp.location.nearbyStops,\n    stopsIndex: state.otp.transitIndex.stops\n  }\n}\n\nconst mapDispatchToProps = {\n  forgetPlace,\n  forgetSearch,\n  setLocation,\n  setQueryParam,\n  toggleTracking\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserSettings)\n"]}